#!/bin/bash
# CODEX - THE BUILDER (Powered by Gemini CLI)
# Usage: ./codex "Build Request"

export CI=true
export NON_INTERACTIVE=1

TASK_CONTENT="$1"
SYSTEM_PROMPT="You represent CODEX, the Engineer. 
Your goal is to IMPLEMENT code, write files, and execute commands to solve the request.
Do NOT ask for confirmation. Use tools directly.
If an error occurs, try to fix it."

# If $1 is a file path, read it
if [ -f "$TASK_CONTENT" ]; then
    TASK_CONTENT=$(cat "$TASK_CONTENT")
fi

# Run Gemini CLI in YOLO mode
gemini -p "$SYSTEM_PROMPT\n\nTASK:\n$TASK_CONTENT" --approval-mode yolo --output-format text
