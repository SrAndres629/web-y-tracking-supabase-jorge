<!-- ========== UNIFIED MAIN NAVIGATION ========== -->
<nav id="mainNav"
    class="fixed top-0 w-full z-50 transition-all duration-500 backdrop-blur-md bg-luxury-black/80 border-b border-white/5">
    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
        <!-- Logo Elite -->
        <a href="{{ url_for('read_root') }}"
            class="group flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-luxury-gold/10 border border-luxury-gold/30 flex items-center justify-center transition-all duration-500 group-hover:border-luxury-gold group-hover:shadow-glow-gold-sm">
                <span class="text-luxury-gold font-serif text-xs font-bold">J</span>
            </div>
            <span class="text-white font-serif text-xl md:text-2xl font-bold tracking-tight group-hover:text-luxury-gold transition-colors duration-500">
                Jorge Aguirre <span class="text-luxury-gold">Flores</span>
            </span>
        </a>

        <!-- Desktop Menu -->
        <ul class="hidden md:flex items-center space-x-8 text-sm font-medium text-gray-300">
            <li><a href="{{ url_for('read_root') }}#galeria" class="hover:text-luxury-gold transition-colors relative group">
                    Galería
                    <span
                        class="absolute -bottom-1 left-0 w-0 h-0.5 bg-luxury-gold transition-all duration-300 group-hover:w-full"></span>
                </a></li>
            <li>
                <div class="relative group">
                    <button class="hover:text-luxury-gold transition-colors flex items-center gap-1 group">
                        Servicios <i class="fas fa-chevron-down text-[10px] transition-transform group-hover:rotate-180"></i>
                    </button>
                    <div class="absolute top-full left-1/2 -translate-x-1/2 mt-4 w-48 bg-luxury-black/95 backdrop-blur-2xl border border-white/5 rounded-2xl p-4 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto transition-all duration-300 shadow-2xl">
                        <ul class="space-y-3">
                            <li><a href="{{ url_for('read_microblading') }}" class="text-xs hover:text-luxury-gold transition-colors block">Microblading HD</a></li>
                            <li><a href="{{ url_for('read_brows') }}" class="text-xs hover:text-luxury-gold transition-colors block">Sombreado Dual</a></li>
                            <li><a href="{{ url_for('read_eyes') }}" class="text-xs hover:text-luxury-gold transition-colors block">Ocular Precision</a></li>
                            <li><a href="{{ url_for('read_lips') }}" class="text-xs hover:text-luxury-gold transition-colors block">Full Lip Velvet</a></li>
                        </ul>
                    </div>
                </div>
            </li>
            <li><a href="{{ url_for('read_root') }}#proceso" class="hover:text-luxury-gold transition-colors relative group">
                    Proceso
                    <span
                        class="absolute -bottom-1 left-0 w-0 h-0.5 bg-luxury-gold transition-all duration-300 group-hover:w-full"></span>
                </a></li>
            <li><a href="{{ url_for('read_root') }}#testimonios" class="hover:text-luxury-gold transition-colors relative group">
                    Testimonios
                    <span
                        class="absolute -bottom-1 left-0 w-0 h-0.5 bg-luxury-gold transition-all duration-300 group-hover:w-full"></span>
                </a></li>
        </ul>

        <div class="flex items-center gap-4">
            <!-- CTA Button (Visible on scroll via JS) -->
            <button id="navCta" type="button" onclick="handleConversion('Nav CTA')"
                class="hidden md:flex opacity-0 translate-y-[-10px] transition-all duration-500 btn-primary items-center gap-2 shadow-glow-gold">
                <i class="fab fa-whatsapp text-lg"></i> Agendar
            </button>

            <!-- Mobile Menu Button -->
            <button id="mobileMenuBtn" type="button" class="md:hidden text-luxury-gold text-2xl focus:outline-none"
                aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenu"
        class="fixed inset-0 bg-luxury-black/98 backdrop-blur-xl z-[60] hidden flex-col items-center justify-center space-y-8 touch-none"
        onclick="closeMobileMenuOnOutside(event)">
        <button type="button" class="absolute top-6 right-6 text-white/50 hover:text-white text-4xl"
            aria-label="Cerrar menú"
            onclick="closeMobileMenu()">
            ×
        </button>
        <a href="{{ url_for('read_root') }}#galeria" class="text-2xl font-serif text-white hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Galería</a>
        <div class="flex flex-col items-center space-y-4">
            <span class="text-[10px] uppercase tracking-[0.3em] text-luxury-gold font-bold">Servicios Elite</span>
            <a href="{{ url_for('read_microblading') }}" class="text-xl font-serif text-white/80 hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Microblading HD</a>
            <a href="{{ url_for('read_brows') }}" class="text-xl font-serif text-white/80 hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Sombreado Dual</a>
            <a href="{{ url_for('read_eyes') }}" class="text-xl font-serif text-white/80 hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Ocular Precision</a>
            <a href="{{ url_for('read_lips') }}" class="text-xl font-serif text-white/80 hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Full Lip Velvet</a>
        </div>
        <a href="{{ url_for('read_root') }}#proceso" class="text-2xl font-serif text-white hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Proceso</a>
        <a href="{{ url_for('read_root') }}#testimonios"
            class="text-2xl font-serif text-white hover:text-luxury-gold transition-colors" onclick="closeMobileMenu()">Testimonios</a>
        <button type="button" onclick="handleConversion('Mobile Menu CTA'); closeMobileMenu();"
            class="mt-8 px-8 py-4 border border-luxury-gold text-luxury-gold uppercase tracking-widest text-sm rounded-lg hover:bg-luxury-gold hover:text-black transition-all">
            Agendar Cita
        </button>
    </div>
</nav>

<script>
    // Mobile menu handlers
    function closeMobileMenu() {
        document.getElementById('mobileMenu').classList.add('hidden');
        document.getElementById('mobileMenuBtn').style.display = 'block';
        document.body.style.overflow = '';
    }
    
    function closeMobileMenuOnOutside(event) {
        if (event.target.id === 'mobileMenu') {
            closeMobileMenu();
        }
    }
    
    // Close on ESC key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            const menu = document.getElementById('mobileMenu');
            if (menu && !menu.classList.contains('hidden')) {
                closeMobileMenu();
            }
        }
    });
    
    // Close on scroll (optional UX improvement)
    let lastScrollY = window.scrollY;
    window.addEventListener('scroll', function() {
        const menu = document.getElementById('mobileMenu');
        if (menu && !menu.classList.contains('hidden')) {
            // Close if scrolled more than 100px
            if (Math.abs(window.scrollY - lastScrollY) > 100) {
                closeMobileMenu();
            }
        }
        lastScrollY = window.scrollY;
    }, { passive: true });
</script>