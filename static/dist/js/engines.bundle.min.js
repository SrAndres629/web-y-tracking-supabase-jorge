var AppEngines=function(e){"use strict";const t={cookies:{get(e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let i=n[e].trim();if(0===i.indexOf(t))return i.substring(t.length)}return null},set(e,t,n=30,i={}){const{path:r="/",sameSite:s="Lax",secure:a=!1}=i;let o="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),o="; expires="+e.toUTCString()}let c=e+"="+encodeURIComponent(t)+o+"; path="+r+"; SameSite="+s;(a||"https:"===window.location.protocol)&&(c+="; Secure"),document.cookie=c},delete(e){this.set(e,"",-1)}},session:{get(e,t=null){try{const n=sessionStorage.getItem(e);return n||t}catch(e){return t}},set(e,t){try{return sessionStorage.setItem(e,t),!0}catch(e){return!1}}}},n={generate:()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),short:(e="id")=>`${e}_${Math.random().toString(36).substr(2,9)}`,externalId(){return`user_${this.generate().substring(0,18)}`}},i={services:window.SERVICES_CONFIG||{},phone:window.CONTACT_CONFIG&&window.CONTACT_CONFIG.phone||"59164714751",whatsappBaseUrl:"https://wa.me/",endpoints:{track:"/track/event",identity:"/api/identity/google"},eventCacheMinutes:15,cookieTTL:{eventId:.01,externalId:365,fbc:90,fbclid:30},conversionMap:{"Hero CTA":{name:"DiseÃ±o de Cejas",id:"hero_offer",intent:"discovery"},"Sticky Header":{name:"Consulta General",id:"sticky_bar",intent:"convenience"},"Floating Button":{name:"Consulta WhatsApp",id:"float_btn",intent:"convenience"},"GalerÃ­a CTA":{name:"TransformaciÃ³n Completa",id:"gallery_cta",intent:"inspiration"},"CTA Final":{name:"Oferta Limitada",id:"final_offer",intent:"urgency"},"Servicio Cejas":{name:"Microblading 3D",id:"service_brows",intent:"service_interest"},"Servicio Ojos":{name:"Delineado Ojos",id:"service_eyes",intent:"service_interest"},"Servicio Labios":{name:"Labios Full Color",id:"service_lips",intent:"service_interest"},"Sticky Mobile CTA":{name:"Cita VIP MÃ³vil",id:"mobile_sticky",intent:"convenience"}},sliderServices:{names:["Microblading 3D","Delineado Permanente","Labios Full Color"],ids:["microblading_3d","delineado_ojos","labios_full"]},viewContentDwellTime:3e3,retry:{maxAttempts:20,interval:500,timeout:1e4}},r={_metaEventId:null,_externalId:null,_fbc:null,_fbp:null,init(){return this._hydrateEventId(),this._hydrateExternalId(),this._syncFbclid(),this._hydrateFbp(),window.META_EVENT_ID=this._metaEventId,window.EXTERNAL_ID=this._externalId,{eventId:this._metaEventId,externalId:this._externalId,fbc:this._fbc,fbp:this._fbp}},_hydrateEventId(){if(window.META_EVENT_ID)return void(this._metaEventId=window.META_EVENT_ID);const e=t.cookies.get("_event_id_cache");e?this._metaEventId=e:(this._metaEventId=n.generate(),t.cookies.set("_event_id_cache",this._metaEventId,i.cookieTTL.eventId))},_hydrateExternalId(){if(window.EXTERNAL_ID)return void(this._externalId=window.EXTERNAL_ID);const e=t.cookies.get("external_id");e?this._externalId=e:(this._externalId=n.externalId(),t.cookies.set("external_id",this._externalId,i.cookieTTL.externalId))},_syncFbclid(){const e=new URLSearchParams(window.location.search).get("fbclid");if(e){const n=Math.floor(Date.now());this._fbc=`fb.1.${n}.${e}`,t.cookies.set("_fbc",this._fbc,i.cookieTTL.fbc),t.session.set("tracking_fbclid",e)}else this._fbc=t.cookies.get("_fbc")},_hydrateFbp(){const e=document.cookie.split("; ").find(e=>e.startsWith("_fbp="));this._fbp=e?e.split("=")[1]:null},get eventId(){return this._metaEventId},get externalId(){return this._externalId},get fbc(){return this._fbc},get fbp(){return this._fbp},generateEventId:(e="event")=>`${e}_${n.generate()}`},s=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","fbclid"],a="tracking_",o={capture(){const e=new URLSearchParams(window.location.search),n={};return s.forEach(i=>{const r=e.get(i);r&&(n[i]=r,t.session.set(`${a}${i}`,r))}),n},get:e=>t.session.get(`${a}${e}`),getAll(){const e={};return s.forEach(t=>{const n=this.get(t);n&&(e[t]=n)}),e},getTrafficSource(){return this.get("utm_source")||"direct"},detectBrowserContext(){const e=navigator.userAgent||navigator.vendor||window.opera;return/FBAN|FBAV|Instagram|TikTok/i.test(e)?"in_app":"browser"},clear(){s.forEach(e=>{try{sessionStorage.removeItem(`${a}${e}`)}catch(e){}})}},c={_retryQueue:[],_retryTimer:null,_debugMode:!1,init(e={}){this._debugMode=e.debug||new URLSearchParams(window.location.search).has("debug_pixel")},track(e,t={},n={}){const i=n.eventId||this._generateEventId(),r={...t,eventID:i};return this._isZarazReady()?(this._sendToZaraz(e,r),{success:!0,channel:"zaraz",eventId:i}):this._isFbqReady()?(this._sendToFbq("track",e,t,{eventID:i}),{success:!0,channel:"fbq",eventId:i}):(this._queueEvent("track",e,t,{eventID:i}),{success:!1,channel:"queued",eventId:i})},trackCustom(e,t={},n={}){const i=n.eventId||this._generateEventId();return this._isZarazReady()?(window.zaraz.track(e,{...t,eventID:i}),{success:!0,channel:"zaraz",eventId:i}):this._isFbqReady()?(window.fbq("trackCustom",e,t,{eventID:i}),{success:!0,channel:"fbq",eventId:i}):(this._queueEvent("trackCustom",e,t,{eventID:i}),{success:!1,channel:"queued",eventId:i})},_isZarazReady:()=>window.zaraz&&"function"==typeof window.zaraz.track,_isFbqReady:()=>"function"==typeof window.fbq,_sendToZaraz(e,t){window.zaraz.track(e,t),this._log(`âœ… Zaraz Edge Event: ${e}`,t)},_sendToFbq(e,t,n,i){window.fbq(e,t,n,i),this._log(`âœ… Pixel Fired (Legacy): ${t}`)},_queueEvent(e,t,n,i){this._retryQueue.push({method:e,eventName:t,data:n,options:i,time:Date.now()}),this._retryTimer||(this._log(`â³ Zaraz/Pixel not ready. Queuing event: ${t}`),this._startRetryLoop())},_startRetryLoop(){const{retry:e}=i;this._retryTimer=setInterval(()=>{const t=this._isZarazReady(),n=this._isFbqReady();if(t||n){const e=t?"zaraz":"fbq";this._log(`ðŸš€ ${e} loaded! Replaying ${this._retryQueue.length} events.`),this._retryQueue.forEach(e=>{t?window.zaraz.track(e.eventName,{...e.data,...e.options}):window.fbq(e.method,e.eventName,e.data,e.options)}),this._retryQueue=[],clearInterval(this._retryTimer),this._retryTimer=null}this._retryQueue.length>0&&Date.now()-this._retryQueue[0].time>e.timeout&&(console.warn("âŒ Zaraz/Pixel failed to load. Aborting retries."),this._retryQueue=[],clearInterval(this._retryTimer),this._retryTimer=null)},e.interval)},_generateEventId:()=>`evt_${Math.random().toString(36).substr(2,9)}`,_log(e,t){this._debugMode&&console.log(e,t||"")}},d={async track(e,t={}){const n=this._buildPayload(e,t);try{if(navigator.sendBeacon&&"Contact"===e){const e=new Blob([JSON.stringify(n)],{type:"application/json"});return navigator.sendBeacon(i.endpoints.track,e),{success:!0,method:"beacon"}}const t=await fetch(i.endpoints.track,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0});return t.ok?{success:!0,method:"fetch"}:(console.warn(`[CAPI] Server Error: ${t.status}`),{success:!1,error:`HTTP ${t.status}`})}catch(t){return console.warn(`[CAPI] Network Error for ${e}`,t),{success:!1,error:t.message}}},_buildPayload(e,t){const n=o.getAll();return{event_name:e,event_time:Math.floor(Date.now()/1e3),event_id:t.event_id||`${e.toLowerCase()}_${Date.now()}`,event_source_url:window.location.href,action_source:"website",user_data:{external_id:r.externalId,fbc:r.fbc,fbp:r.fbp},custom_data:{...t,fbclid:n.fbclid,fbp:r.fbp,utm_source:n.utm_source,utm_medium:n.utm_medium,utm_campaign:n.utm_campaign,utm_term:n.utm_term,utm_content:n.utm_content,browser_context:o.detectBrowserContext(),turnstile_token:window.turnstileToken||null}}},trackAsync(e,t){"requestIdleCallback"in window?requestIdleCallback(()=>this.track(e,t)):setTimeout(()=>this.track(e,t),10)}},l={$:(e,t=document)=>t.querySelector(e),$$:(e,t=document)=>Array.from(t.querySelectorAll(e)),exists:e=>null!==document.querySelector(e),ready(e){"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",e,{once:!0})},observe(e,t,n={}){const i={threshold:.6,rootMargin:"100px",...n},r=new IntersectionObserver(e=>{e.forEach(t)},i);return e&&r.observe(e),r},throttle(e,t=100){let n=0;return(...i)=>{const r=Date.now();r-n>=t&&(n=r,e.apply(this,i))}},debounce(e,t=250){let n;return(...i)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,i),t)}}},u={_viewedSections:new Set,_viewTimers:{},init(){this._setupViewContentObserver(),this._setupSliderListeners()},_setupViewContentObserver(){if(!("IntersectionObserver"in window))return;const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.dataset.serviceCategory||e.target.dataset.trackingId;t&&(e.isIntersecting?this._startViewTimer(t,e.target):this._cancelViewTimer(t))})},{threshold:.6});l.$$("[data-service-category]").forEach(t=>e.observe(t))},_startViewTimer(e,t){this._viewedSections.has(e)||this._viewTimers[e]||(this._viewTimers[e]=setTimeout(()=>{this._viewedSections.add(e),this._trackViewContent(e),delete this._viewTimers[e]},i.viewContentDwellTime))},_cancelViewTimer(e){this._viewTimers[e]&&(clearTimeout(this._viewTimers[e]),delete this._viewTimers[e])},_trackViewContent(e){const t=i.services[e]||{name:e,category:"General",price:0},n=r.generateEventId("vc");c.track("ViewContent",{content_name:t.name,content_category:t.category,content_ids:[e],content_type:"product",value:t.price,currency:"USD"},{eventId:n}),d.trackAsync("ViewContent",{event_id:n,service:t.name,category:t.category,price:t.price})},_setupSliderListeners(){const e=l.$$(".ba-slider"),{names:t,ids:n}=i.sliderServices;e.forEach((e,i)=>{const s=()=>{if(e.dataset.tracked)return;e.dataset.tracked="true";const s=e.dataset.serviceCategory||n[i]||`slider_${i}`,a=e.dataset.serviceCategory?e.dataset.serviceCategory.replace(/_/g," ").toUpperCase():t[i]||"Servicio Desconocido",o=r.generateEventId("slider");c.trackCustom("SliderInteraction",{content_name:a,content_id:s,interaction_type:"compare_before_after"},{eventId:o}),d.trackAsync("SliderInteraction",{event_id:o,service_name:a,service_id:s,interaction_type:"compare_before_after"})};e.addEventListener("click",s,{passive:!0}),e.addEventListener("touchmove",s,{passive:!0})})}},_={handle(e){const t=this._getConversionData(e),n=r.generateEventId("contact");c.track("Contact",{content_name:t.name,content_category:t.intent,content_ids:[t.id],lead_source:"whatsapp",trigger_location:e},{eventId:n}),d.trackAsync("Contact",{event_id:n,source:e,service_data:t}),this._redirectToWhatsApp(e,t)},_getConversionData:e=>i.conversionMap[e]||{name:e,id:"unknown",intent:"general"},_buildMessage(e,t){const n=r.externalId?` [Ref: ${r.externalId.substring(0,8)}]`:"";let i="Hola Jorge ðŸ‘‹";return"Floating Button"===e?i="Hola Jorge, estoy visitando tu web y me interesa una valoraciÃ³n para maquillaje permanente. Â¿PodrÃ­an asesorarme?":"service_interest"===t.intent?i+=` Me interesa el *${t.name}*. Â¿PodrÃ­a ver si soy candidata?`:"urgency"===t.intent?i+=" Quisiera aprovechar la *Oferta Limitada* de valoraciÃ³n gratuita.":i+=" Quisiera informaciÃ³n sobre sus servicios de maquillaje permanente.",i+n},_redirectToWhatsApp(e,t){const n=this._buildMessage(e,t),r=`${i.whatsappBaseUrl}${i.phone}?text=${encodeURIComponent(n)}`,s=window.event;s&&s.target&&s.target.closest("a")||setTimeout(()=>{window.open(r,"_blank")},300)}};const h={initialized:!1,debugMode:!1,turnstileToken:null,isHuman:!1,init(e={}){if(this.initialized)return this;this.initialized=!0,this.debugMode=e.debug||new URLSearchParams(window.location.search).has("debug_pixel");const t=r.init();this._log("ðŸ†” Identity:",t.externalId);const n=o.capture();return this._log("ðŸ“¡ Traffic Source:",o.getTrafficSource(),n),c.init({debug:this.debugMode}),u.init(),d.trackAsync("PageView",{event_id:t.eventId}),this._log("ðŸ“Š [Tracking Engine] Active (Zaraz + CAPI)"),this},track(e,t,n={}){const i=n.eventId||r.generateEventId();return c.track(e,t,{eventId:i}),d.trackAsync(e,{...t,event_id:i}),{eventId:i}},trackCustom(e,t,n={}){const i=n.eventId||r.generateEventId();return c.trackCustom(e,t,{eventId:i}),d.trackAsync(e,{...t,event_id:i}),{eventId:i}},convert:e=>_.handle(e),handleConversion:e=>_.handle(e),_log(e,...t){this.debugMode&&console.log(e,...t)},trackEvent(e,t={}){return this.track(e,t)},generateUUID:()=>n.generate(),setCookie(e,n,i){t.cookies.set(e,n,i)},getCookie:e=>t.cookies.get(e),safeFbq:(e,t,n,i)=>c.track(t,n,i)};"undefined"!=typeof window&&(window.TrackingEngine=h,window.handleConversion=function(e){return _.handle(e)});const v={initialized:!1,NavManager:{nav:null,isScrolled:!1,init(){this.nav=document.querySelector(".glass-nav-premium"),this.nav&&(this._setupScrollListener(),this._setupMobileMenu())},_setupScrollListener(){const e=()=>{const e=window.scrollY>50;e!==this.isScrolled&&(this.isScrolled=e,this.nav.classList.toggle("scrolled",e))};window.addEventListener("scroll",e,{passive:!0}),e()},_setupMobileMenu(){const e=document.querySelector(".mobile-menu-toggle"),t=document.querySelector(".mobile-menu");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("open"),e.setAttribute("aria-expanded",t.classList.contains("open"))})}},SliderManager:{sliders:[],observer:null,init(){const e=document.querySelectorAll(".slider-container");e.length&&(this._setupObserver(),e.forEach(e=>this.observer.observe(e)),window.addEventListener("resize",this._debounce(()=>{this.sliders.forEach(e=>e.update&&e.update())},250),{passive:!0}))},_setupObserver(){this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(this._setupSlider(e.target),this.observer.unobserve(e.target))})},{rootMargin:"100px"})},_setupSlider(e){if(e.dataset.initialized)return;const t=e.querySelector(".ba-slider"),n=e.querySelector(".slider-range"),i=e.querySelector(".resize");if(!t||!n||!i)return;const r=()=>{const e=n.value;i.style.width=`${e}%`,t.classList.toggle("show-after",e>50)};n.addEventListener("input",r),r();const s=e.querySelector(".slider-arrow.left"),a=e.querySelector(".slider-arrow.right");s&&s.addEventListener("click",()=>{n.value=25,r()}),a&&a.addEventListener("click",()=>{n.value=75,r()}),e.dataset.initialized="true",this.sliders.push({update:r})},_debounce(e,t){let n;return(...i)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,i),t)}}},CROManager:{init(){this._setupWhatsAppTooltip(),this._setupStickyCTA()},_setupWhatsAppTooltip(){const e=document.getElementById("whatsappTooltip"),t=document.getElementById("experienceBadge"),n=document.getElementById("whatsappPremium");e&&n&&(setTimeout(()=>{e.classList.add("active"),t&&t.classList.add("active"),n.classList.add("pulse"),setTimeout(()=>{e.classList.remove("active"),n.classList.remove("pulse")},8e3)},5e3),n.addEventListener("click",()=>{e.classList.remove("active"),n.classList.remove("pulse")}))},_setupStickyCTA(){const e=document.querySelector(".sticky-cta");if(!e)return;const t=new IntersectionObserver(t=>{t.forEach(t=>{e.classList.toggle("visible",!t.isIntersecting)})},{threshold:0}),n=document.querySelector(".hero-cta");n&&t.observe(n)}},init(){this.initialized||(this.initialized=!0,this.NavManager.init(),this.SliderManager.init(),"requestIdleCallback"in window?requestIdleCallback(()=>this._deferredInit()):setTimeout(()=>this._deferredInit(),50),console.log("âœ¨ [UI Engine] Active"))},_deferredInit(){this.CROManager.init()}};function g(e={}){return!1!==e.tracking&&h.init({debug:e.debug}),!1!==e.ui&&v.init(),!1!==e.motion&&window.MotionEngine&&window.MotionEngine.init(),{tracking:h,ui:v}}"undefined"!=typeof window&&(window.UIEngine=v),"undefined"!=typeof window&&(window.initEngines=g,"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",()=>{window.enginesManualInit||g()}));var m={init:g,TrackingEngine:h,UIEngine:v};return e.TrackingEngine=h,e.UIEngine=v,e.default=m,e.initEngines=g,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=engines.bundle.min.js.map
